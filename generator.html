<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Генератор Паттернов для Лото</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for number inputs */
        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] {
            -moz-appearance: textfield;
        }
        /* Custom focus ring color */
        .focus\:ring-red-500:focus {
            --tw-ring-color: #ef4444;
        }
        /* Styles for the ad modal */
        .modal-overlay {
            transition: opacity 0.3s ease;
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-900 dark:text-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-2xl bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 md:p-8 relative">
        <!-- Back to Home Button -->
        <a href="index.html" class="absolute top-4 left-4 text-sm text-indigo-600 hover:text-indigo-800 dark:text-indigo-400 dark:hover:text-indigo-200 transition-colors">&larr; На главную</a>

        <!-- Logo -->
        <img src="https://placehold.co/150x50/6366f1/ffffff?text=ЛОГОТИП" alt="Логотип" class="mx-auto h-12 w-auto mb-4 mt-8 md:mt-2">

        <h1 class="text-2xl md:text-3xl font-bold text-center text-gray-800 dark:text-white mb-2">Генератор комбинаций</h1>
        <p class="text-center text-gray-500 dark:text-gray-400 mb-6">Введите 9 уникальных чисел от 1 до 37.</p>

        <!-- Form for number input -->
        <form id="numberForm" class="grid grid-cols-3 gap-4 mb-6">
            <!-- Input fields will be generated by script -->
        </form>

        <!-- Generate Button -->
        <div class="flex justify-center mb-6">
            <button type="submit" form="numberForm" class="w-full md:w-auto bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-8 rounded-lg shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-offset-gray-800 transition-transform transform hover:scale-105">
                Сгенерировать
            </button>
        </div>

        <!-- Results and Error Display -->
        <div id="messageArea" class="text-center min-h-[24px]"></div>
        <div id="resultsArea" class="mt-6 space-y-3"></div>
    </div>

    <!-- Ad Modal -->
    <div id="adModal" class="modal-overlay fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50 opacity-0 pointer-events-none">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 text-center w-full max-w-md">
            <h3 class="text-lg font-semibold mb-2 dark:text-white">Пожалуйста, подождите</h3>
            <p class="mb-4 dark:text-gray-300">Ваши комбинации готовы! <br>Наш сервис работает благодаря рекламе.</p>
            
            <!-- Ad Placeholder: Replace this with your ad code -->
            <div id="ad-container" class="min-w-[300px] min-h-[250px] bg-gray-200 dark:bg-gray-700 flex items-center justify-center rounded my-4">
                 <p class="text-gray-500 dark:text-gray-400">Здесь будет ваш рекламный блок</p>
            </div>
            
            <button id="closeAdButton" class="w-full bg-gray-200 hover:bg-gray-300 dark:bg-gray-600 dark:hover:bg-gray-500 text-gray-800 dark:text-white font-bold py-2 px-4 rounded transition-colors">
                Показать комбинации
            </button>
        </div>
    </div>


    <script>
        // --- Application Setup ---
        const form = document.getElementById('numberForm');
        const resultsArea = document.getElementById('resultsArea');
        const messageArea = document.getElementById('messageArea');
        const adModal = document.getElementById('adModal');
        const closeAdButton = document.getElementById('closeAdButton');
        let numberInputs = [];
        let validatedUserNumbers = []; // To store numbers for generation after ad

        // The predefined patterns
        const patterns = [
            [1, 2, 3, 4, 5, 6], [1, 2, 3, 7, 8, 9], [1, 2, 4, 5, 7, 9],
            [1, 2, 4, 6, 7, 8], [1, 2, 5, 6, 8, 9], [1, 3, 4, 5, 8, 9],
            [1, 3, 5, 6, 7, 8], [1, 3, 4, 6, 7, 9], [2, 3, 4, 5, 7, 8],
            [2, 3, 5, 6, 7, 9], [2, 3, 4, 6, 8, 9], [4, 5, 6, 7, 8, 9]
        ];

        // --- Functions ---

        /**
         * Dynamically creates and injects the 9 number input fields into the form.
         */
        function createInputFields() {
            let formHTML = '';
            for (let i = 0; i < 9; i++) {
                formHTML += `
                    <div class="relative">
                        <label for="num${i}" class="absolute -top-2.5 left-2 inline-block bg-white dark:bg-gray-800 px-1 text-xs font-medium text-gray-500 dark:text-gray-400">Число ${i + 1}</label>
                        <input type="number" id="num${i}" name="num${i}" min="1" max="37" class="block w-full rounded-md border-0 py-2.5 px-3 text-gray-900 dark:text-white bg-transparent shadow-sm ring-1 ring-inset ring-gray-300 dark:ring-gray-600 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6 transition-shadow duration-150" required>
                    </div>
                `;
            }
            form.innerHTML = formHTML;
            // After creating inputs, populate the numberInputs array
            numberInputs = Array.from({ length: 9 }, (_, i) => document.getElementById(`num${i}`));
            // Add live validation listeners to the new inputs
            numberInputs.forEach(input => {
                input.addEventListener('input', checkForDuplicates);
            });
        }

        /**
         * Validates all number inputs for duplicates in real-time.
         * @returns {boolean} - True if duplicates are found, false otherwise.
         */
        function checkForDuplicates() {
            numberInputs.forEach(input => input.classList.remove('ring-red-500', 'focus:ring-red-500'));
            const values = numberInputs.map(input => input.value).filter(value => value.trim() !== '');
            const seen = new Set();
            const duplicates = new Set();
            for (const value of values) {
                if (seen.has(value)) duplicates.add(value);
                else seen.add(value);
            }
            if (duplicates.size > 0) {
                displayMessage('Найдены повторяющиеся числа. Введите уникальные значения.', 'error');
                numberInputs.forEach(input => {
                    if (duplicates.has(input.value)) {
                        input.classList.add('ring-red-500', 'focus:ring-red-500');
                    }
                });
                return true;
            } else {
                if (messageArea.textContent.startsWith('Найдены')) messageArea.innerHTML = '';
                return false;
            }
        }
        
        /**
         * Displays a message to the user.
         * @param {string} message - The message to display.
         * @param {string} type - 'error' or 'info'.
         */
        function displayMessage(message, type) {
            const color = type === 'error' ? 'text-red-500' : 'text-green-500';
            messageArea.innerHTML = `<p class="${color} font-medium">${message}</p>`;
        }

        /**
         * Generates and displays the result combinations based on stored user numbers.
         */
        function generateAndDisplayResults() {
            resultsArea.innerHTML = ''; // Clear previous results
            patterns.forEach((pattern, index) => {
                const resultString = pattern
                    .map(p_num => validatedUserNumbers[p_num - 1])
                    .sort((a, b) => a - b)
                    .join(' - '); // Using dash for better readability

                const resultCard = document.createElement('div');
                resultCard.className = 'bg-gray-50 dark:bg-gray-700/50 p-4 rounded-lg shadow-sm flex items-center justify-between animate-fade-in';
                
                const tourText = document.createElement('span');
                tourText.className = 'font-semibold text-gray-600 dark:text-gray-300';
                tourText.textContent = `Комбинация ${index + 1}:`;

                const numbersText = document.createElement('span');
                numbersText.className = 'font-mono text-lg text-indigo-600 dark:text-indigo-400 tracking-wider';
                numbersText.textContent = resultString;

                resultCard.appendChild(tourText);
                resultCard.appendChild(numbersText);
                resultsArea.appendChild(resultCard);
            });
        }

        // --- Event Listeners ---

        // Main form submission logic
        form.addEventListener('submit', function(event) {
            event.preventDefault();
            resultsArea.innerHTML = '';
            
            if (checkForDuplicates()) return;

            const userNumbers = [];
            let hasError = false;
            for (const inputField of numberInputs) {
                const value = inputField.value;
                if (value === '') {
                    displayMessage('Пожалуйста, введите все 9 чисел.', 'error');
                    inputField.classList.add('ring-red-500', 'focus:ring-red-500');
                    hasError = true;
                    break;
                }
                const num = parseInt(value, 10);
                if (isNaN(num) || num < 1 || num > 37) {
                    displayMessage('Неверный ввод. Введите числа от 1 до 37.', 'error');
                    inputField.classList.add('ring-red-500', 'focus:ring-red-500');
                    hasError = true;
                    break;
                }
                userNumbers.push(num);
            }

            if (!hasError) {
                messageArea.innerHTML = '';
                validatedUserNumbers = userNumbers; // Store valid numbers
                // Show the ad modal
                adModal.classList.remove('opacity-0', 'pointer-events-none');
            }
        });

        // Close modal and generate results
        closeAdButton.addEventListener('click', () => {
            adModal.classList.add('opacity-0', 'pointer-events-none');
            generateAndDisplayResults();
        });

        // --- Initialization ---
        
        // Run when the document is fully loaded
        document.addEventListener('DOMContentLoaded', () => {
            createInputFields();
        });

    </script>
</body>
</html>
